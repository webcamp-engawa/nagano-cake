<!DOCTYPE html>
<html>
  <head>
    <title>NaganoCake</title>
    <%= csrf_meta_tags %>
    <%= csp_meta_tag %>

    <%= stylesheet_link_tag    'application', media: 'all', 'data-turbolinks-track': 'reload' %>
    <%= javascript_include_tag 'application', 'data-turbolinks-track': 'reload' %>
  </head>

  <body>
    <header class="navbar navbar-fixed-top navbar-inverse">
              <div class="container">
                    <nav>
                      <ul class="list-inline-item">
                        <% if customer_signed_in? %>
                          <li class ="list-inline-item"><%= link_to "Top", root_path %></li>
                          <li class ="list-inline-item"><%= link_to "About", home_about_path %></li>
                          <li class ="list-inline-item"><%= link_to "カート", cart_items_path %></li>
                          <li class ="list-inline-item"><%= link_to "Log out", destroy_customer_session_path, method: :delete %></li>
                          <!-- 検索ボックス -->

                          <!--ここまで -->
                          <li class ="list-inline-item">ようこそ<%= link_to current_customer.fullname.to_s, customer_path %>さん</li>
                          <% elsif admin_signed_in? %>
                          <li class ="list-inline-item"><%= link_to "商品一覧",admin_items_path %></li>
                          <li class ="list-inline-item"><%= link_to "会員一覧",admin_customers_path %></li>
                          <li class ="list-inline-item"><%= link_to "注文履歴一覧",admin_orders_path(button:1) %></li>
                          <li class ="list-inline-item"><%= link_to "ジャンル管理",admin_genres_path %></li>
                          <li class ="list-inline-item"><%= link_to "ログアウト" ,destroy_admin_session_path, method: :delete %></li>

                        <% else %>
                          <li class ="list-inline-item"><%= link_to "Top", root_path %></li>
                          <li class ="list-inline-item"><%= link_to "About", home_about_path %></li>
                          <li class ="list-inline-item"><%= link_to "Log in", new_customer_session_path %></li>
                          <li class ="list-inline-item"><%= link_to "管理者はこちら" ,new_admin_session_path %></li>

                        <% end %>
                      </ul>
                    </nav>

              </div>
          <div class ="jumbotron jumbotron-fluid">
            <div class="title-cover">
                  <% if customer_signed_in? %>
                  <h2><%= link_to "ながのCAKE", root_path, id: "logo" %></h2>
                      <dl class ="searchbox">
                            <%= search_form_for @search, url: items_path do |f| %>
                            <div class ="searching">
                              <dt><%= f.search_field :name_cont ,placeholder: "キーワード検索", id: :item_name %><%= f.submit ("search") , class: 'search-btn' %></dt>
                            </div>
                            <% end %>
                      </dl>
                  <% elsif admin_signed_in? %>
                  <h2><%= link_to "ながのCAKE", admin_root_path, id: "logo" %></h2>
                  <% else %>
                  <h2><%= link_to "ながのCAKE", root_path, id: "logo" %></h2>
                  <% end %>
            </div>
          </div>
    </header>



        <%= yield %>
        <script>
          $(function() {
            const dataList = function(request, response) {
              $.ajax({
                url: '/items/autocomplete_name/' + request.term,
                dataType: 'json',
                type: 'GET',
                cache: true,
                success: function(data) {
                  response(data);
                },
                error: function(XMLHttpRequest, textStatus, errorThrown) {
                  response(['']);
                }
              });
            }

            // #item_nameの部分は必要に応じてidなり指定してください
            $('#item_name').autocomplete({
              source: dataList,
              autoFocus: true, // 自動的に先頭の項目にフォーカスするか
              delay: 100, // 入力してからサジェストが動くまでの時間(ms)
              minLength: 1 // 2文字入力しないとサジェストが動かない
            })
          });
        </script>

  </body>
</html>
